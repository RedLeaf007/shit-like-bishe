"use strict";(self["webpackChunkvue3_nb0"]=self["webpackChunkvue3_nb0"]||[]).push([[553],{23553:(e,t,l)=>{l.r(t),l.d(t,{default:()=>z});l(6603),l(62807),l(2968),l(30989),l(49127),l(60165),l(30845),l(53220),l(81864),l(9765),l(77126),l(57005),l(36046),l(59900),l(7116),l(48991),l(27258),l(39826);var n=l(83556),a=l(11702),u=(l(31225),l(49583)),r=l(40202),i=l(9479),o=l(79580),c=l(21256),s=l(76809),d=(l(86424),l(14881),l(73451),l(70070),{class:"formModel_btn_box"});const v={__name:"formModel",emits:["formModelChange"],setup:function(e,t){var l,a=t.expose,r=t.emit,i=(0,o.oR)(),v=(0,n.Fl)((function(){return i.getters["user/session"]})),p=null===(l=(0,n.FN)())||void 0===l?void 0:l.appContext.config.globalProperties,f="storeup",m="我的收藏",g=(0,u.iH)({}),w=(0,u.iH)({refid:!1,tablename:!1,name:!1,picture:!1,type:!1,inteltype:!1,remark:!1,userid:!1}),h=(0,u.iH)(!1),_=(0,u.iH)(!1),y=(0,u.iH)(""),b=(0,u.iH)({refid:[],tablename:[],name:[{required:!0,message:"请输入",trigger:"blur"}],picture:[],type:[],inteltype:[],remark:[],userid:[{required:!0,message:"请输入",trigger:"blur"}]}),k=(0,u.iH)(null),W=(0,u.iH)(0),x=(0,u.iH)(""),C=function(e){g.value.picture=e},H=function(){g.value={refid:"",tablename:"",name:"",picture:"",inteltype:"",remark:"",userid:""}},U=function(){null===p||void 0===p||p.$http({url:"".concat(f,"/info/").concat(W.value),method:"get"}).then((function(e){new RegExp("../../../file","g");g.value=e.data.data,h.value=!0}))},z=(0,u.iH)(""),$=(0,u.iH)(""),V=(0,u.iH)(""),Z=(0,u.iH)(""),j=(0,u.iH)(""),q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(H(),e&&(W.value=e,x.value=t),"add"==t)_.value=!0,y.value="新增"+m,h.value=!0;else if("info"==t)_.value=!1,y.value="查看"+m,U();else if("edit"==t)_.value=!0,y.value="修改"+m,U();else if("cross"==t){for(var o in _.value=!0,y.value=l,n)"refid"!=o?"tablename"!=o?"name"!=o?"picture"!=o?"type"!=o?"inteltype"!=o?"remark"!=o?"userid"!=o||(g.value.userid=n[o],w.value.userid=!0):(g.value.remark=n[o],w.value.remark=!0):(g.value.inteltype=n[o],w.value.inteltype=!0):(g.value.type=n[o],w.value.type=!0):(g.value.picture=n[o],w.value.picture=!0):(g.value.name=n[o],w.value.name=!0):(g.value.tablename=n[o],w.value.tablename=!0):(g.value.refid=n[o],w.value.refid=!0);n&&(z.value=n),a&&($.value=a),r&&(V.value=r),u&&(Z.value=u),i&&(j.value=i),h.value=!0}};a({init:q});var N=function(){h.value=!1},R=function(){var e=(0,s.Z)((0,c.Z)().mark((function e(){var t,l,n,a,u;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=g.value.picture&&(g.value.picture=g.value.picture.replace(new RegExp(null===p||void 0===p?void 0:p.$config.url,"g"),"")),$.value,t=JSON.parse(JSON.stringify(z.value)),l="",n="",a="","cross"==x.value&&""!=Z.value)if(Z.value.startsWith("["))l=v.value.id,n=t["id"],a=Z.value.replace(/\[/,"").replace(/\]/,"");else{for(u in t)u==Z.value&&(t[u]=j.value);S(t)}k.value.validate((function(e){if(e)if(l&&n){g.value.crossuserid=l,g.value.crossrefid=n;var t={page:1,limit:1e3,crossuserid:g.value.crossuserid,crossrefid:g.value.crossrefid};null===p||void 0===p||p.$http({url:"".concat(f,"/page"),method:"get",params:t}).then((function(e){if(e.data.data.total>=a)return null===p||void 0===p||p.$toolUtil.message("".concat(V.value),"error"),!1;null===p||void 0===p||p.$http({url:"".concat(f,"/").concat(g.value.id?"update":"save"),method:"post",data:g.value}).then(function(){var e=(0,s.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r("formModelChange"),null===p||void 0===p||p.$toolUtil.message("操作成功","success"),h.value=!1;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}else null===p||void 0===p||p.$http({url:"".concat(f,"/").concat(g.value.id?"update":"save"),method:"post",data:g.value}).then(function(){var e=(0,s.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r("formModelChange"),null===p||void 0===p||p.$toolUtil.message("操作成功","success"),h.value=!1;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());else p.$message.error("请完善信息")}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=(0,s.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("cross"!=x.value){e.next=3;break}return e.next=3,null===p||void 0===p?void 0:p.$http({url:"".concat($.value,"/update"),method:"post",data:t}).then((function(e){}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return function(e,t){var l=(0,n.up)("el-input"),a=(0,n.up)("el-form-item"),u=(0,n.up)("el-col"),r=(0,n.up)("uploads"),i=(0,n.up)("el-row"),o=(0,n.up)("el-form"),c=(0,n.up)("el-button"),s=(0,n.up)("el-dialog");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(s,{"modal-class":"edit_form_modal",class:"edit_form",modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=function(e){return h.value=e}),title:y.value,width:"80%","destroy-on-close":"",fullscreen:!1},(0,n.Nv)({default:(0,n.w5)((function(){return[(0,n.Wm)(o,{class:"formModel_form",ref_key:"formRef",ref:k,model:g.value,rules:b.value},{default:(0,n.w5)((function(){return[(0,n.Wm)(i,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(u,{span:12},{default:(0,n.w5)((function(){return[(0,n.Wm)(a,{label:"名称",prop:"name"},{default:(0,n.w5)((function(){return[(0,n.Wm)(l,{class:"list_inp",modelValue:g.value.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return g.value.name=e}),placeholder:"名称",type:"text",readonly:!(_.value&&!w.value.name)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1}),(0,n.Wm)(u,{span:12},{default:(0,n.w5)((function(){return[(0,n.Wm)(a,{prop:"picture",label:"图片"},{default:(0,n.w5)((function(){return[(0,n.Wm)(r,{disabled:!(_.value&&!w.value.picture),action:"file/upload",tip:"请上传图片",style:{width:"100%","text-align":"left"},fileUrls:g.value.picture?g.value.picture:"",onChange:C},null,8,["disabled","fileUrls"])]})),_:1})]})),_:1}),(0,n.Wm)(u,{span:12},{default:(0,n.w5)((function(){return[(0,n.Wm)(a,{label:"推荐类型",prop:"inteltype"},{default:(0,n.w5)((function(){return[(0,n.Wm)(l,{class:"list_inp",modelValue:g.value.inteltype,"onUpdate:modelValue":t[1]||(t[1]=function(e){return g.value.inteltype=e}),placeholder:"推荐类型",type:"text",readonly:!(_.value&&!w.value.inteltype)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1}),(0,n.Wm)(u,{span:12},{default:(0,n.w5)((function(){return[(0,n.Wm)(a,{label:"备注",prop:"remark"},{default:(0,n.w5)((function(){return[(0,n.Wm)(l,{class:"list_inp",modelValue:g.value.remark,"onUpdate:modelValue":t[2]||(t[2]=function(e){return g.value.remark=e}),placeholder:"备注",type:"text",readonly:!(_.value&&!w.value.remark)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])]})),_:2},[_.value||"logistics"==x.value||"reply"==x.value?{name:"footer",fn:(0,n.w5)((function(){return[(0,n._)("span",d,[(0,n.Wm)(c,{class:"cancel_btn",onClick:N},{default:(0,n.w5)((function(){return[(0,n.Uk)("取消")]})),_:1}),(0,n.Wm)(c,{class:"confirm_btn",type:"primary",onClick:R},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 提交 ")]})),_:1})])]})),key:"0"}:void 0]),1032,["modelValue","title"])])}}};var p=l(97319);const f=(0,p.Z)(v,[["__scopeId","data-v-1df17c04"]]),m=f;var g=function(e){return(0,n.dD)("data-v-313719bc"),e=e(),(0,n.Cn)(),e},w={class:"center_view"},h={class:"list_search_view"},_={class:"search_view"},y=g((function(){return(0,n._)("div",{class:"search_label"}," 名称： ",-1)})),b={class:"search_box"},k={class:"search_btn_view"},W={class:"btn_view"},x={key:0},C={key:1};const H={__name:"list",setup:function(e){var t,l=(0,o.oR)(),c=((0,n.Fl)((function(){return l.getters["user/session"]})),(0,u.iH)(l.state.user.avatar),null===(t=(0,n.FN)())||void 0===t?void 0:t.appContext.config.globalProperties),s="storeup",d="我的收藏",v=(0,r.yj)();(0,n.YP)((function(){return v.query}),(function(){B()})),(0,n.bv)((function(){}));var p=(0,u.iH)(null),f=(0,u.iH)(null),g=(0,u.iH)({page:1,limit:20,sort:"id",order:"desc"}),H=(0,u.iH)({}),U=(0,u.iH)([]),z=(0,u.iH)(!1),$=function(e){(0,n.Y3)((function(){f.value.toggleRowSelection(e)}))},V=function(){z.value=!0;var e=JSON.parse(JSON.stringify(g.value));e["type"]=v.query.type,e["sort"]="id",e["order"]="desc",H.value.name&&""!=H.value.name&&(e["name"]="%"+H.value.name+"%"),c.$http({url:"".concat(s,"/page"),method:"get",params:e}).then((function(e){z.value=!1,p.value=e.data.data.list,q.value=Number(e.data.data.total)}))},Z=function(e){var t=(0,u.iH)([]);if(e)t.value=[e];else{if(!U.value.length)return!1;for(var l in U.value)t.value.push(U.value[l].id)}i.T.confirm("是否删除选中".concat(d),"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then((function(){c.$http({url:"".concat(s,"/delete"),method:"post",data:t.value}).then((function(e){null===c||void 0===c||c.$toolUtil.message("删除成功","success",(function(){V()}))}))}))},j=function(e){U.value=e},q=(0,u.iH)(0),N=(0,u.iH)(["total","prev","pager","next","sizes","jumper"]),R=function(e){g.value.limit=e,V()},S=function(e){g.value.page=e,V()},M=function(e,t){return null===c||void 0===c?void 0:c.$toolUtil.isAuth(e,t)},D=function(){g.value.page=1,V()},F=(0,u.iH)(null),J=function(){D()},O=function(){F.value.init()},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?F.value.init(e,"edit"):U.value.length&&F.value.init(U.value[0].id,"edit")},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?F.value.init(e,"info"):U.value.length&&F.value.init(U.value[0].id,"info")},B=function(){V()};return B(),function(e,t){var l=(0,n.up)("el-input"),u=(0,n.up)("el-button"),r=(0,n.up)("el-form"),i=(0,n.up)("el-table-column"),o=(0,n.up)("el-image"),c=(0,n.up)("el-table"),s=(0,n.up)("el-pagination"),d=(0,n.Q2)("loading");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",w,[(0,n._)("div",h,[(0,n.Wm)(r,{model:H.value,class:"search_form"},{default:(0,n.w5)((function(){return[(0,n._)("div",_,[y,(0,n._)("div",b,[(0,n.Wm)(l,{class:"search_inp",modelValue:H.value.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return H.value.name=e}),placeholder:"名称",clearable:""},null,8,["modelValue"])])]),(0,n._)("div",k,[(0,n.Wm)(u,{class:"search_btn",type:"primary",onClick:t[1]||(t[1]=function(e){return D()}),size:"small"},{default:(0,n.w5)((function(){return[(0,n.Uk)("搜索")]})),_:1})])]})),_:1},8,["model"]),(0,n._)("div",W,[M("storeup","新增")?((0,n.wg)(),(0,n.j4)(u,{key:0,class:"add_btn",type:"success",onClick:O},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 新增 ")]})),_:1})):(0,n.kq)("",!0),M("storeup","删除")?((0,n.wg)(),(0,n.j4)(u,{key:1,class:"del_btn",type:"danger",disabled:!U.value.length,onClick:t[2]||(t[2]=function(e){return Z(null)})},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 删除 ")]})),_:1},8,["disabled"])):(0,n.kq)("",!0)])]),M("storeup","查看")?(0,n.wy)(((0,n.wg)(),(0,n.j4)(c,{key:0,border:"",stripe:!0,onSelectionChange:j,ref_key:"table",ref:f,data:p.value,onRowClick:$},{default:(0,n.w5)((function(){return[(0,n.Wm)(i,{resizable:!0,align:"left","header-align":"left",type:"selection",width:"55"}),(0,n.Wm)(i,{label:"序号",width:"70",resizable:!0,align:"left","header-align":"left"},{default:(0,n.w5)((function(e){return[(0,n.Uk)((0,a.zw)((g.value.page-1)*g.value.limit+e.$index+1),1)]})),_:1}),(0,n.Wm)(i,{"min-width":"140",resizable:!0,sortable:!0,align:"left","header-align":"left",prop:"name",label:"名称"},{default:(0,n.w5)((function(e){return[(0,n.Uk)((0,a.zw)(e.row.name),1)]})),_:1}),(0,n.Wm)(i,{label:"图片","min-width":"140",width:"120",resizable:!0,sortable:!0,align:"left","header-align":"left"},{default:(0,n.w5)((function(t){return[t.row.picture?((0,n.wg)(),(0,n.iD)("div",x,["http"==t.row.picture.substring(0,4)?((0,n.wg)(),(0,n.j4)(o,{key:0,"preview-teleported":"","preview-src-list":[t.row.picture.split(",")[0]],src:t.row.picture.split(",")[0],style:{width:"100px",height:"100px"}},null,8,["preview-src-list","src"])):((0,n.wg)(),(0,n.j4)(o,{key:1,"preview-teleported":"","preview-src-list":[e.$config.url+t.row.picture.split(",")[0]],src:e.$config.url+t.row.picture.split(",")[0],style:{width:"100px",height:"100px"}},null,8,["preview-src-list","src"]))])):((0,n.wg)(),(0,n.iD)("div",C,"无图片"))]})),_:1}),(0,n.Wm)(i,{"min-width":"140",resizable:!0,sortable:!0,align:"left","header-align":"left",prop:"inteltype",label:"推荐类型"},{default:(0,n.w5)((function(e){return[(0,n.Uk)((0,a.zw)(e.row.inteltype),1)]})),_:1}),(0,n.Wm)(i,{"min-width":"140",resizable:!0,sortable:!0,align:"left","header-align":"left",prop:"remark",label:"备注"},{default:(0,n.w5)((function(e){return[(0,n.Uk)((0,a.zw)(e.row.remark),1)]})),_:1}),(0,n.Wm)(i,{label:"操作",width:"300",resizable:!0,sortable:!0,align:"left","header-align":"left"},{default:(0,n.w5)((function(e){return[M("storeup","查看")?((0,n.wg)(),(0,n.j4)(u,{key:0,class:"view_btn",type:"info",onClick:function(t){return T(e.row.id)}},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 详情 ")]})),_:2},1032,["onClick"])):(0,n.kq)("",!0),M("storeup","修改")?((0,n.wg)(),(0,n.j4)(u,{key:1,class:"edit_btn",type:"primary",onClick:function(t){return P(e.row.id)}},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 修改 ")]})),_:2},1032,["onClick"])):(0,n.kq)("",!0),M("storeup","删除")?((0,n.wg)(),(0,n.j4)(u,{key:2,class:"del_btn",type:"danger",onClick:function(t){return Z(e.row.id)}},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 删除 ")]})),_:2},1032,["onClick"])):(0,n.kq)("",!0)]})),_:1})]})),_:1},8,["data"])),[[d,z.value]]):(0,n.kq)("",!0),(0,n.Wm)(s,{background:"",layout:N.value.join(","),total:q.value,"page-size":g.value.limit,"current-page":g.value.page,"onUpdate:currentPage":t[3]||(t[3]=function(e){return g.value.page=e}),"prev-text":"<","next-text":">","hide-on-single-page":!1,style:{width:"100%",padding:"0",margin:"20px 0 0",whiteSpace:"nowrap",color:"#333",fontWeight:"500"},"page-sizes":[10,20,30,40,50,100],onSizeChange:R,onCurrentChange:S},null,8,["layout","total","page-size","current-page"])]),(0,n.Wm)(m,{ref_key:"formRef",ref:F,onFormModelChange:J},null,512)])}}},U=(0,p.Z)(H,[["__scopeId","data-v-313719bc"]]),z=U}}]);
//# sourceMappingURL=553.19af9ee6.js.map